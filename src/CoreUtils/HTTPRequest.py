import re
import requests


def Http_Get(url):
    message = ""
    try:
        response = requests.get(url, timeout=3)
    except Exception as exception:
        message = exception
        return None, message
    if response.status_code == 200:
        return response, message
    else:
        return None, message


def Https_Get(url):
    message = ""
    try:
        response = requests.get(url, verify=False, timeout=3)
    except Exception as exception:
        message = exception
        return None, message
    if response.status_code == 200:
        return response, message
    else:
        return None, message


def Web_Page_Title(response):
    content = str(response.text)
    title = re.findall('<title>(.+)</title>', content)
    return title[0]


def Http_Title_Scan(ip, port):
    response = None
    message = None
    url = "http://%s:%s" % (str(ip), str(port))
    response, message = Http_Get(url)
    if response is not None:
            return Web_Page_Title(response), message


def Https_Title_Scan(ip, port):
    response = None
    message = None
    url = "https://%s:%s" % (str(ip), str(port))
    response, message = Https_Get(url)
    if response is not None:
        return Web_Page_Title(response), message
    else:
        return None, message

